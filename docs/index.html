<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interface with General Bikeshare Feed Specification Files • gbfs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Interface with General Bikeshare Feed Specification Files">
<meta property="og:description" content="Supplies a set of functions to interface with General Bikeshare 
    Feed Specification .json feeds in R, allowing users to save and accumulate 
    tidy .rds datasets for specified cities/bikeshare programs.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">gbfs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ds-civic-data/gbfs">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="general-bikeshare-feed-specification---r-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#general-bikeshare-feed-specification---r-package" class="anchor"></a>General Bikeshare Feed Specification - R Package</h1></div>
<p><em>Developed by Kaelyn M. Rosenberg (author) and Simon P. Couch (author, maintainer)</em></p>
<p><img src="http://www.r-pkg.org/badges/version/gbfs" alt="CRAN Badge"><a href="https://travis-ci.org/ds-civic-data/gbfs"><img src="https://travis-ci.org/ds-civic-data/gbfs.svg?branch=master" alt="Build Status"></a></p>
<p>The <code>gbfs</code> package supplies a set of functions to interface with General Bikeshare Feed Specification .json feeds in R, allowing users to save and accumulate tidy .rds datasets for specified cities/bikeshare programs. The North American Bikeshare Association’s <a href="https://github.com/NABSA/gbfs">gbfs</a> is a standardized data release format for live information on the status of bikeshare programs, as well as metadata, including counts of bikes at stations, ridership costs, and geographic locations of stations and parked bikes.</p>
<p><strong>Features</strong></p>
<ul>
<li>Get bikeshare data by specifying city or supplying url of feed</li>
<li>All feeds for a city can be saved with a single function</li>
<li>New information from dynamic feeds can be appended to existing datasets</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>We’re now on CRAN! Install the latest release, 1.2.0, with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"gbfs"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gbfs)</a></code></pre></div>
<p>You can install the development version of <code>gbfs</code> from github with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"ds-civic-data/gbfs"</span>)</a></code></pre></div>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The <code>gbfs</code> is a standardized data feed describing the current status of a bikeshare program.</p>
<p>Although all of the data is live, only a few of the datasets change often:</p>
<ul>
<li>
<code>station_status</code>: Supplies the number of available bikes and docks at each station as well as station availability</li>
<li>
<code>free_bike_status</code>: Gives the coordinates and metadata on available bikes that are parked, but not at a station.</li>
</ul>
<p>In this package, these two datasets are considered “dynamic”, and can be specified as desired datasets by setting <code>feeds = "dynamic"</code> in the main wrapper function in the package, <code>get_gbfs</code>.</p>
<p>Much of the data supplied in this specification can be considered static. If you want to grab all of these for a given city, set <code>feeds = "static'</code> when calling <code>get_gbfs</code>. Static feeds include:</p>
<ul>
<li>
<code>system_information</code>: Basic metadata about the bikeshare program</li>
<li>
<code>station_information</code>: Information on the capacity and coordinates of stations</li>
<li>Several optional feeds: <code>system_hours</code>, <code>system_calendar</code>, <code>system_regions</code>, <code>system_pricing_plans</code>, and <code>system_alerts</code>
</li>
</ul>
<p>Each of the above feeds can be queried with the <code>get_suffix</code> function, where <code>suffix</code> is replaced with the name of the relevant feed.</p>
<p>For more details on the official <code>gbfs</code> spec, see <a href="https://github.com/NABSA/gbfs/blob/master/gbfs.md">this document</a>.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>In this example, we’ll grab data from Portland, Oregon’s Biketown bikeshare program and visualize some of the different datasets.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># load necessary packages</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a></code></pre></div>
<p>First, we’ll grab some information on the stations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># grab portland station information and return it as a dataframe</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">pdx_station_info &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_station_information.html">get_station_information</a></span>(<span class="st">"portland"</span>, <span class="dt">output =</span> <span class="st">"return"</span>)</a></code></pre></div>
<p>…as well as the number of bikes at each station.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># grab current capacity at each station and return it as a dataframe</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">pdx_station_status &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_station_status.html">get_station_status</a></span>(<span class="st">"portland"</span>, <span class="dt">output =</span> <span class="st">"return"</span>)</a></code></pre></div>
<p>Joining these datasets, we can get the capacity at each station, along with each station’s metadata.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># full join these two datasets on station_id and select a few columns</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">pdx_stations &lt;-<span class="st"> </span><span class="kw">full_join</span>(pdx_station_info, </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                          pdx_station_status, </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                          <span class="dt">by =</span> <span class="st">"station_id"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="co"># just select columns we're interested in visualizing</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="dt">id =</span> station_id, </a>
<a class="sourceLine" id="cb6-7" data-line-number="7">         lon, </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">         lat, </a>
<a class="sourceLine" id="cb6-9" data-line-number="9">         num_bikes_available, </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">         num_docks_available) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="st">"docked"</span>)</a></code></pre></div>
<p>Finally, before we plot, lets grab the locations of the bikes parked in Portland that are not docked at a station,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># grab data on free bike status and save it as a dataframe</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">pdx_free_bikes &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_free_bike_status.html">get_free_bike_status</a></span>(<span class="st">"portland"</span>, <span class="dt">output =</span> <span class="st">"return"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="co"># just select columns we're interested in visualizing</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="dt">id =</span> bike_id, lon, lat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="co"># make columns analogous to station_status for row binding</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_bikes_available =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">         <span class="dt">num_docks_available =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">         <span class="dt">type =</span> <span class="st">"free"</span>)</a></code></pre></div>
<p>…and bind these dataframes together!</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># row bind stationed and free bike info</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">pdx_full &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(pdx_stations, pdx_free_bikes)</a></code></pre></div>
<p>Now, plotting,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># filter out stations with 0 available bikes</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">pdx_full <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(num_bikes_available <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="co"># plot the geospatial distribution of bike counts</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> lon, </a>
<a class="sourceLine" id="cb9-7" data-line-number="7">      <span class="dt">y =</span> lat, </a>
<a class="sourceLine" id="cb9-8" data-line-number="8">      <span class="dt">size =</span> num_bikes_available, </a>
<a class="sourceLine" id="cb9-9" data-line-number="9">      <span class="dt">col =</span> type) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="st">  </span><span class="co"># make aesthetics slightly more cozy</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">"qual"</span>)</a></code></pre></div>
<p><img src="README-plot-1.png"><!-- --></p>
<p>Folks who have spent a significant amount of time in Portland might be able to pick out the Willamette River running Northwest/Southeast through the city. With a few lines of <code>gbfs</code>, <code>dplyr</code>, and <code>ggplot2</code>, we can pick together a meaningful visualization to help us better understand how bikeshare bikes are distributed throughout Portland.</p>
<p>Some other features worth playing around with in <code>gbfs</code> that weren’t touched on in this example:</p>
<ul>
<li>The main wrapper function in the package, <code>get_gbfs</code>, will grab every dataset for a given city. (We call the functions to grab individual datasets above for clarity.)</li>
<li>We set <code>output = "return"</code> in all of the above calls—if you leave the output argument as default and supply a directory, <code>gbfs</code> will save the dataframes in your local files.<br>
</li>
<li>When the <code>output</code> argument is left as default in <code>get_free_bike_status</code> and <code>get_station_status</code> (the functions for the <code>dynamic</code> dataframes,) and a dataframe already exists at the given path, <code>gbfs</code> will row bind the dataframes, allowing for the capability to accumulate large datasets over time.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=gbfs">https://​cloud.r-project.org/​package=gbfs</a>
</li>
<li>Browse source code at <br><a href="https://github.com/ds-civic-data/gbfs">https://​github.com/​ds-civic-data/​gbfs</a>
</li>
<li>Report a bug at <br><a href="https://github.com/ds-civic-data/gbfs/issues">https://​github.com/​ds-civic-data/​gbfs/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>CC0</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kaelyn Rosenberg <br><small class="roles"> Author </small>  </li>
<li>Simon P. Couch <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kaelyn Rosenberg, Simon P. Couch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
