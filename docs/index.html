<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interface with Live Bikeshare Data • gbfs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Interface with Live Bikeshare Data">
<meta property="og:description" content="Supplies a set of functions to interface with bikeshare data
    following the General Bikeshare Feed Specification, allowing users to query
    and accumulate tidy datasets for specified cities/bikeshare programs.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">gbfs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/simonpcouch/gbfs/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="general-bikeshare-feed-specification---r-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#general-bikeshare-feed-specification---r-package" class="anchor"></a>General Bikeshare Feed Specification - R Package <a href="https://gbfs.netlify.com"><img src="https://raw.githubusercontent.com/simonpcouch/gbfs/master/figures/hex.png" align="right" height="200"></a>
</h1></div>

<p>The <code>gbfs</code> package supplies a set of functions to interface with General Bikeshare Feed Specification .json feeds in R, allowing users to save and accumulate tidy .rds datasets for specified cities/bikeshare programs. The North American Bikeshare Association’s <a href="https://github.com/NABSA/gbfs">gbfs</a> is a standardized data release format for live information on the status of bikeshare programs, as well as metadata, including counts of bikes at stations, ridership costs, and geographic locations of stations and parked bikes.</p>
<p><strong>Features</strong></p>
<ul>
<li>Get bikeshare data by specifying city name or supplying url of feed</li>
<li>All feeds for a city can be saved with a single function</li>
<li>New information from dynamic feeds can be appended to existing datasets</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>We’re on CRAN! Install the latest release with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"gbfs"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gbfs</span>)</pre></div>
<p>You can install the developmental version of <code>gbfs</code> from GitHub with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"ds-civic-data/gbfs"</span>)</pre></div>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The <code>gbfs</code> is a standardized data feed describing the current status of a bikeshare program.</p>
<p>Although all of the data is live, only a few of the datasets change often:</p>
<ul>
<li>
<code>station_status</code>: Supplies the number of available bikes and docks at each station as well as station availability</li>
<li>
<code>free_bike_status</code>: Gives the coordinates and metadata on available bikes that are parked, but not at a station.</li>
</ul>
<p>In this package, these two datasets are considered “dynamic”, and can be specified as desired datasets by setting <code>feeds = "dynamic"</code> in the main wrapper function in the package, <code>get_gbfs</code>.</p>
<p>Much of the data supplied in this specification can be considered static. If you want to grab all of these for a given city, set <code>feeds = "static'</code> when calling <code>get_gbfs</code>. Static feeds include:</p>
<ul>
<li>
<code>system_information</code>: Basic metadata about the bikeshare program</li>
<li>
<code>station_information</code>: Information on the capacity and coordinates of stations</li>
<li>Several optional feeds: <code>system_hours</code>, <code>system_calendar</code>, <code>system_regions</code>, <code>system_pricing_plans</code>, and <code>system_alerts</code>
</li>
</ul>
<p>Each of the above feeds can be queried with the <code>get_suffix</code> function, where <code>suffix</code> is replaced with the name of the relevant feed.</p>
<p>For more details on the official <code>gbfs</code> spec, see <a href="https://github.com/NABSA/gbfs/blob/master/gbfs.md">this document</a>.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>In this example, we’ll grab data from Portland, Oregon’s Biketown bikeshare program and visualize some of the different datasets.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co"># load necessary packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)</pre></div>
<p>First, we’ll grab some information on the stations.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="co"># grab portland station information and return it as a dataframe</span>
<span class="no">pdx_station_info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/get_station_information.html">get_station_information</a></span>(<span class="st">"portland"</span>)
<span class="co">#&gt; Message: Returning the output data as an object, rather than saving it, since the `directory` argument was not specified. Setting `output = "return"` will silence this message.</span>

<span class="co"># check it out!</span>
<span class="fu">glimpse</span>(<span class="no">pdx_station_info</span>)
<span class="co">#&gt; Observations: 158</span>
<span class="co">#&gt; Variables: 7</span>
<span class="co">#&gt; $ station_id     &lt;chr&gt; "hub_1512", "hub_1513", "hub_1514", "hub_1515", "hub_1…</span>
<span class="co">#&gt; $ name           &lt;chr&gt; "SW 10th at Harvey Milk ", "SE Gideon at 12th Ave MAX …</span>
<span class="co">#&gt; $ region_id      &lt;chr&gt; "region_241", "region_241", "region_241", "region_241"…</span>
<span class="co">#&gt; $ lon            &lt;dbl&gt; -122.6811, -122.6535, -122.6395, -122.6534, -122.6663,…</span>
<span class="co">#&gt; $ lat            &lt;dbl&gt; 45.52175, 45.50281, 45.50357, 45.50513, 45.51148, 45.5…</span>
<span class="co">#&gt; $ address        &lt;chr&gt; "404 Southwest 10th Avenue, Portland", "1201-1241 Sout…</span>
<span class="co">#&gt; $ rental_methods &lt;list&gt; [&lt;"KEY", "APPLEPAY", "ANDROIDPAY", "TRANSITCARD", "AC…</span></pre></div>
<p>…as well as the number of bikes at each station.</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="co"># grab current capacity at each station and return it as a dataframe</span>
<span class="no">pdx_station_status</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/get_station_status.html">get_station_status</a></span>(<span class="st">"portland"</span>)
<span class="co">#&gt; Message: Returning the output data as an object, rather than saving it, since the `directory` argument was not specified. Setting `output = "return"` will silence this message.</span>

<span class="co"># check it out!</span>
<span class="fu">glimpse</span>(<span class="no">pdx_station_status</span>)
<span class="co">#&gt; Observations: 158</span>
<span class="co">#&gt; Variables: 14</span>
<span class="co">#&gt; $ station_id          &lt;chr&gt; "hub_1512", "hub_1513", "hub_1514", "hub_1515", "…</span>
<span class="co">#&gt; $ num_bikes_available &lt;int&gt; 3, 8, 8, 5, 9, 4, 8, 4, 6, 0, 9, 6, 1, 8, 6, 5, 0…</span>
<span class="co">#&gt; $ num_bikes_disabled  &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ num_docks_available &lt;int&gt; 14, 2, 4, 13, 7, 10, 8, 13, 12, 12, 8, 6, 7, 8, 6…</span>
<span class="co">#&gt; $ is_installed        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span>
<span class="co">#&gt; $ is_renting          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span>
<span class="co">#&gt; $ is_returning        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span>
<span class="co">#&gt; $ last_reported       &lt;int&gt; 1585249873, 1585249873, 1585249873, 1585249873, 1…</span>
<span class="co">#&gt; $ last_updated        &lt;dttm&gt; 2020-03-26 12:11:13, 2020-03-26 12:11:13, 2020-0…</span>
<span class="co">#&gt; $ year                &lt;dbl&gt; 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2…</span>
<span class="co">#&gt; $ month               &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…</span>
<span class="co">#&gt; $ day                 &lt;int&gt; 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 2…</span>
<span class="co">#&gt; $ hour                &lt;int&gt; 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 1…</span>
<span class="co">#&gt; $ minute              &lt;int&gt; 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 1…</span></pre></div>
<p>Just like that, we have two tidy datasets containing information about Portland’s bikeshare program.</p>
<p>Joining these datasets, we can get the capacity at each station, along with each station’s metadata.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="co"># full join these two datasets on station_id and select a few columns</span>
<span class="no">pdx_stations</span> <span class="kw">&lt;-</span> <span class="fu">full_join</span>(<span class="no">pdx_station_info</span>,
                          <span class="no">pdx_station_status</span>,
                          <span class="kw">by</span> <span class="kw">=</span> <span class="st">"station_id"</span>) <span class="kw">%&gt;%</span>
  <span class="co"># just select columns we're interested in visualizing</span>
  <span class="fu">select</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">station_id</span>,
         <span class="no">lon</span>,
         <span class="no">lat</span>,
         <span class="no">num_bikes_available</span>,
         <span class="no">num_docks_available</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"docked"</span>)</pre></div>
<p>Finally, before we plot, lets grab the locations of the bikes parked in Portland that are not docked at a station,</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="co"># grab data on free bike status and save it as a dataframe</span>
<span class="no">pdx_free_bikes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/get_free_bike_status.html">get_free_bike_status</a></span>(<span class="st">"portland"</span>, <span class="kw">output</span> <span class="kw">=</span> <span class="st">"return"</span>) <span class="kw">%&gt;%</span>
  <span class="co"># just select columns we're interested in visualizing</span>
  <span class="fu">select</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="no">bike_id</span>, <span class="no">lon</span>, <span class="no">lat</span>) <span class="kw">%&gt;%</span>
  <span class="co"># make columns analogous to station_status for row binding</span>
  <span class="fu">mutate</span>(<span class="kw">num_bikes_available</span> <span class="kw">=</span> <span class="fl">1</span>,
         <span class="kw">num_docks_available</span> <span class="kw">=</span> <span class="fl">NA</span>,
         <span class="kw">type</span> <span class="kw">=</span> <span class="st">"free"</span>)</pre></div>
<p>…and bind these dataframes together!</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="co"># row bind stationed and free bike info</span>
<span class="no">pdx_full</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">pdx_stations</span>, <span class="no">pdx_free_bikes</span>)</pre></div>
<p>Now, plotting,</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="co"># filter out stations with 0 available bikes</span>
<span class="no">pdx_plot</span> <span class="kw">&lt;-</span> <span class="no">pdx_full</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">num_bikes_available</span> <span class="kw">&gt;</span> <span class="fl">0</span>) <span class="kw">%&gt;%</span>
  <span class="co"># plot the geospatial distribution of bike counts</span>
  <span class="fu">ggplot</span>() +
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">lon</span>,
      <span class="kw">y</span> <span class="kw">=</span> <span class="no">lat</span>,
      <span class="kw">size</span> <span class="kw">=</span> <span class="no">num_bikes_available</span>,
      <span class="kw">col</span> <span class="kw">=</span> <span class="no">type</span>) +
  <span class="fu">geom_point</span>() +
  <span class="co"># make aesthetics slightly more cozy</span>
  <span class="fu">theme_minimal</span>() +
  <span class="fu">scale_color_brewer</span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"qual"</span>)</pre></div>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">pdx_plot</span></pre></div>
<p><a href="https://github.com/simonpcouch/gbfs"><img src="https://raw.githubusercontent.com/simonpcouch/gbfs/master/figures/plot-1.png" height="500"></a></p>
<p>Folks who have spent a significant amount of time in Portland might be able to pick out the Willamette River running Northwest/Southeast through the city. With a few lines of <code>gbfs</code>, <code>dplyr</code>, and <code>ggplot2</code>, we can put together a meaningful visualization to help us better understand how bikeshare bikes are distributed throughout Portland.</p>
<p>Some other features worth playing around with in <code>gbfs</code> that weren’t touched on in this example:</p>
<ul>
<li>The main wrapper function in the package, <code>get_gbfs</code>, will grab every dataset for a given city. (We call the functions to grab individual datasets above for clarity.)</li>
<li>In the above lines, we output the datasets as returned dataframes. If you’d rather save the output to your local files, check out the <code>directory</code> and <code>return</code> arguments.</li>
<li>When the <code>output</code> argument is left as default in <code>get_free_bike_status</code> and <code>get_station_status</code> (the functions for the <code>dynamic</code> dataframes,) and a dataframe already exists at the given path, <code>gbfs</code> will row bind the dataframes, allowing for the capability to accumulate large datasets over time.</li>
<li>If you’re not sure if your city supplies <code>gbfs</code> feeds, you might find the <code>get_gbfs_cities</code> and <code>get_which_gbfs_feeds</code> functions useful.</li>
</ul>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>Please note that the <code>gbfs</code> R package is released with a <a href="CONTRIBUTING.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=gbfs">https://​cloud.r-project.org/​package=gbfs</a>
</li>
<li>Browse source code at <br><a href="https://github.com/simonpcouch/gbfs/">https://​github.com/​simonpcouch/​gbfs/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/simonpcouch/gbfs/issues">https://​github.com/​simonpcouch/​gbfs/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>CC0</li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Simon P. Couch <br><small class="roles"> Author, maintainer </small>  </li>
<li>Kaelyn Rosenberg <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=gbfs"><img src="https://www.r-pkg.org/badges/version/gbfs" alt="CRAN status"></a></li>
<li><a href="https://travis-ci.org/simonpcouch/gbfs"><img src="https://travis-ci.org/simonpcouch/gbfs.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://codecov.io/gh/simonpcouch/gbfs?branch=master"><img src="https://codecov.io/gh/simonpcouch/gbfs/branch/master/graph/badge.svg" alt="Testing Coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Simon P. Couch, Kaelyn Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
